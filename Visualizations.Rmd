---
title: "Visualizations"
author: "Sarah Greenwood"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ggplot workshop
### Setup:
Load libraries and data for the workshop. Tidyverse includes ggplot. 

```{r}
library(tidyverse)
library(gapminder)
library(readr)
data(gapminder)
```

```{r}
schooldata <- read_csv("~/team/bootcamp/R/schooldata.csv")

```

### Base R Histogram
Automatically decides number of bins, labels, and returns counts.  
```{r}
#hist(schooldata$grade)
```

Adding breaks changes the number of bins.
```{r}
hist(schooldata$grade, breaks = 30)
```

```{r}
hist(schooldata$grade, 
     breaks = seq(.875, 4.125, .25), # this controls where the breaks are
     xlim = c(0,4), # lower and upper limits of x axis
     main = "Grade Distribution", # main title of graph
     xlab = "Grade", # x label 
     ylab = "Count") # y label
```

```{r}
plot(x=gapminder$gdpPercap[gapminder$year==2002],
     y=gapminder$lifeExp[gapminder$year==2002], 
     log="x")
pdf("plot1.pdf", width = 6, height = 4)

#return plot
dev.off() 
```

### ggplot 
```{r}
ggplot(schooldata, aes(grade)) +
  geom_histogram(bins = 20)
```

```{r}
ggplot(schooldata, aes(grade)) +
  geom_histogram(binwidth = .25) + 
  xlim(0, NA) + #this tells R to figure out the top bound itself
  xlab("Grade") + # x label 
  ylab("Count") + # y label
  ggtitle("Grade Distribution") # graph title
```

The real power of ggplot comes when we want to split up our data. 

```{r}
ggplot(schooldata, aes(grade)) +
  geom_histogram(binwidth = .25) + 
  xlim(0, NA) +
  xlab("Grade") + 
  ylab("Count") + 
  ggtitle("Grade Distribution") +
  facet_grid(gender ~ .) # formula syntax "I'm going to split by gender..."
```
What if I want to remove the missing data? 

```{r}
schooldata %>% 
  filter(!is.na(gender)) %>% # WAHOO piping is powerful
  mutate(gender = factor(gender, # this changes the order/labels on the male/female part
                         levels = c("M", "F"), 
                         labels = c("Male", "Female"))) %>%
  ggplot(aes(grade)) +
  geom_histogram(binwidth = .25) + 
  xlim(0, NA) +
  xlab("Grade") + 
  ylab("Count") + 
  ggtitle("Grade Distribution") +
  facet_grid(gender ~ .) 
```

#### Scatterplot

```{r}
gapminder %>%
  filter(year==2002) %>%
  ggplot(aes(x = gdpPercap, y = lifeExp)) + 
  geom_point() + 
  scale_x_log10() # this transforms the data
```

```{r}
gapminder %>%
  filter(year==2002) %>%
  ggplot(aes(x = gdpPercap, y = lifeExp, color = continent)) + # adds color!
  geom_point() + 
  scale_x_log10() # this transforms the data

ggsave("p1.pdf", width = 6, height = 4) # this saves the most recent plot
```

### Fun Facts

- If you go Help > Cheatsheets in RStudio, you'll find a ton of nifty cheatsheets! 